@echo off
REM System Vulnerability Scanner - Advanced Tool
call ..\animation-utils.bat :COUNTDOWN 5
cls
echo System Vulnerability Scanner
echo -------------------------
echo.
echo [1/8] Checking Windows Update status...
powershell -Command "Get-HotFix | Sort-Object InstalledOn -Descending | Select-Object -First 10 | Format-Table HotFixID, Description, InstalledOn -AutoSize"
echo [2/8] Checking for weak passwords...
powershell -Command "Get-LocalUser | Where-Object { $_.PasswordRequired -eq $false } | Select-Object Name, Enabled, PasswordRequired"
echo [3/8] Checking firewall status...
powershell -Command "Get-NetFirewallProfile | Select-Object Name, Enabled, DefaultInboundAction, DefaultOutboundAction | Format-Table -AutoSize"
echo [4/8] Checking for open ports...
powershell -Command "Get-NetTCPConnection | Where-Object { $_.State -eq 'Listen' } | Select-Object LocalAddress, LocalPort, OwningProcess | Sort-Object LocalPort | Format-Table -AutoSize"
echo [5/8] Checking antivirus status...
powershell -Command "Get-MpComputerStatus | Select-Object AntivirusEnabled, RealTimeProtectionEnabled, OnAccessProtectionEnabled, IoavProtectionEnabled | Format-List"
echo [6/8] Checking for suspicious scheduled tasks...
powershell -Command "Get-ScheduledTask | Where-Object { $_.Principal.UserId -eq 'SYSTEM' -and $_.Actions.Execute -notlike '*Windows*' } | Select-Object TaskName, State, @{Name='Command';Expression={$_.Actions.Execute}} | Format-Table -AutoSize"
echo [7/8] Checking system integrity...
sfc /verifyonly
echo [8/8] Checking for rootkit indicators...
powershell -Command "Get-Process | Where-Object { $_.ProcessName -eq '' -or $_.MainModule -eq $null } | Select-Object Id, ProcessName, Path"
echo.
echo Vulnerability scan complete! Address any issues found above.
pause
exit /b
